<head>
<title>Rain World Devlog</title>
<link rel="icon" href="/Rain-World-Devlog/Images/Archived Images/ljrr7.jpg">
<style>
a:link {
color:#fab
}
a:visited {
color:#c8a
}
img {
max-width:100%
}
.post {
background-color:#151015ea; border:1px solid #FFFFFF; padding:15px; border-radius: 5px
}
.quoteheader {
font-weight:bold
}
.quote {
background-color:rgba(100,20,90,0.2); border:2px solid #D29
}
.codeheader {
font-weight:bold
}
.code {
background-color:rgba(255,170,187,0.4); border:2px solid #FAB
}</style></head><body style="background-color:#151015; background-image:url(/Rain-World-Devlog/Images/Slugs.png); background-position:center; background-repeat:no-repeat; background-attachment:fixed; background-size:cover; font-family:sans-serif; color:#eee"><span style="background-color:#151015ea"><a href="/Rain-World-Devlog/Pages/027.html">Previous page</a> / <a href="/Rain-World-Devlog/Pages/029.html">Next page</a></span>
<br><br><hr><br><br>
<a name="540"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019062#msg1019062" target="_blank">JLJac on May 02, 2014, 05:56:06 AM (Last Edit: May 02, 2014, 06:01:26 AM):</a></b></td></table><br>Hm, ok, so here&#039;s what I&#039;m trying to do:<br /><br />A standard room is about 1040*800 pixels big. I want to be able to have a level that&#039;t at least three times that size as well, or variable room size isn&#039;t really worth it.<br /><br />If I&#039;m having variable room size, I need to have a movable camera, obviously. If I&#039;m having a movable camera, I want parallax scrolling.<br /><br />Each room consists of 30 bitmap layers (with very few colors) that has previously, in the static camera build, been baked together as one image at level generation. My dream was to in this new version have all those 30 layers move about as parallax scrolling layers when the camera moved. It didn&#039;t seem so impossible - if crysis can be crysis I can have 30 pretty big 2D sprites move around, right?<br /><br />Because I wanted the dynamic shadows as well, I wanted all layers to be in one texture. That way I&#039;d be able to check in say layer 28 if it&#039;s being shaded by say layer 27 by simply asking different coordinates in the same texture for whether or not they&#039;re transparent.<br /><br />So I went ahead and stacked all the layers on top of each other in a texture, and 800*30 = 24 000, so that&#039;s considerably bigger than the limit.<br /><br />And now I think I have to figure out some other way to do this haha &nbsp;<img src="/Rain-World-Devlog/Images/Smileys/cheesy.gif" alt="Cheesy" border="0" /> Maybe I&#039;ll have to drop the parallax scrolling after all, and go with some pre-baked solution - can can still save a depth map for the room graphic and use that to do the dynamic shadows, so all is not lost!<br /><br />Edit: Oh, and yeah, I can save each layer as its own texture, but that would make each room a 32 file, 2 megabyte monster, so I&#039;d prefer not to. My talk about a custom file format is because most pixels actually don&#039;t change from layer to layer, so if I wrote my own compression algorithm that worked on the z-coordinate I could probably get the filesize down some, but I&#039;d still need to unpack it for unity, so it wouldn&#039;t really solve anything.</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#540">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="541"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019070#msg1019070" target="_blank">JLJac on May 02, 2014, 06:20:44 AM:</a></b></td></table><br>Hm, not really, it&#039;s an either-or situation, because the graphics consist of the 30 layers, and if I&#039;m unable to displace them in the game I need to do it in the level editor, and I can&#039;t have two conflicting displacements or every line in the z-dimension would look jagged :/<br /><br />Maybe I can make it happen through some sort of bump mapping-like shader... </div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#541">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="542"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019074#msg1019074" target="_blank">JLJac on May 02, 2014, 06:34:50 AM:</a></b></td></table><br>It seems like a not very elegant solution, is all... Looking at this steep parallax mapping, it looks to me like it&#039;s a fragment shader which basically does a per-pixel raytrace both from the camera to the surface and then from the surface to the light source. Maybe something like that could be done here as well? If they have the time to step back and forth like that on each pixel, what I want to do shouldn&#039;t be impossible either, right?<br /><br /><a href="http://graphics.cs.brown.edu/games/SteepParallax/index.html" target="_blank">http://graphics.cs.brown.edu/games/SteepParallax/index.html</a><br /><br /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#542">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="543"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019093#msg1019093" target="_blank">JLJac on May 02, 2014, 08:26:49 AM:</a></b></td></table><br>Well, it&#039;s not really a question of large sprites moving about as much as one unified terrain that&#039;s just going to be slightly displaced according to the perspective of the camera - so if we wanted it to be done <i>properly </i>parallax scrolling would be the solution, but I think it could very well be solved using some kind of depth map and a shader as well. I.e it&#039;s more about objects being viewed from slightly different angles rather than being moved around.<br /><br />But maybe the dynamic shadows will be enough to give a sense of depth to the scenes, maybe scrolling environments aren&#039;t necessary. I&#039;ll have to go over this in my head a few times before I settle on a decision.</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#543">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="544"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019107#msg1019107" target="_blank">JLJac on May 02, 2014, 09:19:50 AM:</a></b></td></table><br><div class="quoteheader"><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019100#msg1019100">Quote from: Chromanoid on May 02, 2014, 09:01:23 AM</a></div><div class="quote">You should draw the 30 layers one by one in a screen sized render target. Each layer can have multiple textures, just render them as quads (this way your levels can be as big as you want). Then draw the layers again with a custom &quot;depth color&quot; instead of rgb in a low-bit-per-pixel screen sized render target. Now you can do some depth effects with the information from the &quot;depth texture&quot; and the &quot;color texture&quot;. <br /><br />If you run short of memory maybe you can use one texture for multiple textures by using each color channel for one texture.<br /></div>This sounds super nice! And I don&#039;t quite understand what you mean - how does rendering as quads solve the problem with the texture being too big?<br /><br />Dancing dead - Yeah I totally know how you traditionally do parallax scrolling, and that was my original plan! But when I ran into this hurdle I started thinking about the ray tracing shaders such as parallax mapping as another way to solve it, without actually storing all that data, but rather working from something like just a texture and a depth map. The parallax scrolling here isn&#039;t really distinct objects with large distances between them, but rather one single box might consist of 10 layers very close to each other, making it more of a voxel solution. So I though maybe I could fake that effect without doing parallax proper. Like, just bending the edges of stuff a little to fake some shift in angle, like this:<br /><br /><img src="/Rain-World-Devlog/Images/Archived Images/011.gif" alt="" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#544">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="545"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019112#msg1019112" target="_blank">JLJac on May 02, 2014, 09:34:16 AM:</a></b></td></table><br>This is already how I do it! I just bake it together to a single image. All the rain world level art is 30 bitmap layers, each of them slightly smaller than the next, that together form semi-threedimensional objects. What I want to do now is the exact same thing, just at run time - so if I manage to do it it&#039;ll supposedly look the same, just moving.<br /><br />Each layer texture has only a few colors, to indicate what color to grab from a palette. Maybe 6 colors all in all, including white which is treated as transparent. What&#039;s a tilemap? Can it help me?</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#545">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="546"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019143#msg1019143" target="_blank">JLJac on May 02, 2014, 11:25:02 AM:</a></b></td></table><br>&nbsp; <img src="/Rain-World-Devlog/Images/Smileys/cheesy.gif" alt="Cheesy" border="0" /> hahaha ok you guys are right, I&#039;ve gone a bit overboard with this. I had a very particular vision, and an idea of how to make that happen, and when it didnt work I got a bit obsessed with making it work. I&#039;ll just look into other options, such as pre-rendering a few screen positions and switching between them with hard cuts. Don&#039;t worry, I&#039;ve not become crazy obsessed with shaders and I won&#039;t mess up the game hehe <img src="/Rain-World-Devlog/Images/Smileys/tongue.gif" alt="Tongue" border="0" /> </div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#546">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="547"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019265#msg1019265" target="_blank">JLJac on May 03, 2014, 02:30:02 AM:</a></b></td></table><br>Ok, so I actually managed to mock up the thing I want - it looks a little something like this:<br /><br /><img src="/Rain-World-Devlog/Images/Archived Images/C6Ogk.gif" alt="" border="0" /><br /><br />30 layers parallax scrolling voxel like 3D space renderer!<br /><br />Even with the smallest level size and no shadows it still eats away at the frame rate pretty badly. I think I&#039;ll try to figure out some other solution.<br /><br />Maybe the past two days make a little bit more sense now?<br />My original idea was to have all the layers in the same texture, and do a per-pixel raytrace layer for layer in the texture until I hit something. When loading a big texture proved impossible that original approach fell flat, and I&#039;ve been trying to find another solution since. Now I&#039;m pretty tired of all this though, and am contemplating to just have fixed screen positions. It would be nice to show the depth of the rooms like this, but you can&#039;t have it all. I still have high hopes for dynamic shadows falling across the geometry though - that could be done with just depth map and a pre-baked image. </div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#547">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="548"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019760#msg1019760" target="_blank">JLJac on May 05, 2014, 08:49:56 AM:</a></b></td></table><br>Thanks guys! That&#039;s certainly an option, but the thing is that I already have this 30 bitmaps thing set up - that&#039;s how the level editor works already, except it bakes them together. Making it proper 3D would be an entirely different animal all together. I still have issues accepting that 30 sprites with somewhat high-res textures can be an actual issue when Crysis can do entire islands with a bazillion polygons of rain forest and stuff, but I&#039;ll take your word for it.<br /><br /><b>Update 132</b><br />So I had a talk with James, and we decided that before I got manically obsessed with making this tiny little parallax effect work, I could probably follow through on a fixed-screen approach. Especially as we&#039;d most reasonably want both solutions in the game anyway even if I managed to make the parallax work, so we could fix the screen in performance heavy rooms and save the parallax for cinematic set pieces.<br /><br />So, I&#039;ll abandon parallax scrolling for a while in favor of importing 2D backgrounds. In the final spasms of my parallax obsession, I gave the pixel-raytracing some time, and for a wile it looked bright because a 30 iteration for-loop in the fragment shader actually didn&#039;t murder the framerate as badly as I feared. But then some <i>stupid </i>stuff came in the way, namely that in Unity the CG compiler always unrolls all loops (stupid, but necessary on older cards if I got it right) and then if I do some operation in the for loop it assigns <span style="text-decoration: underline;"><b><i>new temporary variables for each iteration</i></b></span> (STUPID, NO EXCUSE) which maxes out the shader&#039;s tiny little working memory and keeps it from compiling.<br /><br />So there I was, at a road fork, where one option was to learn the thing that graphical C compiles to (looks like this: <br /><div class="codeheader">Code:</div><div class="code">add r8.xy, t0, c0<br />add r7.xy, t0, c2<br />add r5.xy, t0, c3<br />add r2.xy, t0, c4<br />mov r0.y, c1.w<br />mov r0.x, c1.z<br />add r9.xy, t0, r0<br />mov r0.y, c2.w<br />mov r0.x, c2.z<br />add r6.xy, t0, r0<br />mov r0.y, c0.w<br />mov r0.x, c0.y<br />add r4.xy, t0, r0<br />mov r0.y, c3.w<br />mov r0.x, c3.z</div>seems to be polish notation and similar horrors)&nbsp; and the other was to decide that f*ck it, for now at least. So I&#039;m trying to convince myself that #2 is the way to go.<br /><br />I&#039;ll probably still get some good opportunity to pull my hair over shaders, if I&#039;m going to do the coloration and the light stuff as a shader.<br /><br />Before we leave the parallax issue, for now, I&#039;ll give you the the most current version of the &quot;30 files, 30 sprites&quot;-solution, to give you an idea of what could&#039;ve been and might actually be if I get back to it later.<br /><br /><img src="/Rain-World-Devlog/Images/Archived Images/kYIHv.gif" alt="" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#548">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="549"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/jamesprimate.jpg" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019845#msg1019845" target="_blank">jamesprimate on May 05, 2014, 04:10:40 PM:</a></b></td></table><br><div class="quoteheader"><a href="https://forums.tigsource.com/index.php?topic=25183.msg1019796#msg1019796">Quote from: Gimym JIMBERT on May 05, 2014, 11:14:53 AM</a></div><div class="quote"><br />If you want to know more about virtual texture, there is amplify on unity, they explain the basic and provide a tool. <a href="http://amplify.pt/unity/amplify-texture/" target="_blank">http://amplify.pt/unity/amplify-texture/</a><br /></div><br />wow this looks like just the ticket</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#549">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="550"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020036#msg1020036" target="_blank">JLJac on May 06, 2014, 11:07:24 AM:</a></b></td></table><br>Thanks guys! Hope we can make this dream come true <img src="/Rain-World-Devlog/Images/Smileys/smiley.gif" alt="Smiley" border="0" /><br />And as always Jimbert, thanks super much! That might actually be a viable solution to some of our problems. I&#039;ll give the trial a test run eventually, when I get back to this parallax thing.<br /><br />Hahaha Ulillillia is wonderful! I&#039;ve never seen anyone care as little about the actual interactive layer in a 2D game&nbsp; <img src="/Rain-World-Devlog/Images/Smileys/cheesy.gif" alt="Cheesy" border="0" /><br /><br /><b>Update 133</b><br />Ok, so despite encouragement and tips I&#039;ve still managed to keep out of the parallax hole. Now I&#039;m starting to set up the infra structure for the 2D level graphics instead.<br /><br />My current idea is this - encode as much visual information as possible into a texture, and then unpack it with a pixel shader. If you guys want to tell me that&#039;s a horrible inefficient way of going about it, now is the time.<br /><br />So, I started by setting up a list of the stuff I need to know for each pixel:<br /><br />its color [0-3] (transparent, shadowed, standard, high light)<br /><br />its depth [0-29] (Needed to give it the correct fog shade, and later to do the cool dynamic shadows I&#039;m hyped about)<br /><br />if it&#039;s lit [bool] (I&#039;ll still pre-bake the light, and save whether or not each pixel is actually lit. If it&#039;s not lit, we can save time in the shader by not doing shadow calculations on it.)<br /><br />if it&#039;s a rainbow pixel [bool] (If you check the screenshots you might notice a little oily effect around the edges of stuff - that)<br /><br />Whether or not it has an effect color [0-3] (No effect color, effect color1, effect color2, white. You know how some plants and stuff tend to be pink or cyan? That&#039;s this. White is used for the flies&#039; hives.)<br /><br />How much of that effect color [0-255] (probably unnecessary resolution here, if I make it 0-50 the gradients would probably still look smooth, given how they&#039;re always on small surfaces)<br /><br />Then I started messing around, and realized that all of this information can be stored in a 24bit rgb pixel! With quite a fat margin, I could store a lot more if I wanted to!<br /><br />So this is my plan:<br /><br /><span style="color: red;">Red channel:<br />0-transparent<br /><br />1-30 = depths 0-29, color shaded, not lit<br />31-60 = depths 0-29, color mid, not lit<br />61-90 = depths 0-29, color highlight, not lit<br /><br />91-120 = depths 0-29, color shaded, lit<br />121-150 = depths 0-29, color mid, lit<br />151-180 = depths 0-29, color highlight, lit</span><br /><br /><span style="color: green;">Green channel:<br />0 = no effect, not a rainbow pixel<br />1 = level effect color1, not a rainbow pixel<br />2 = level effect color2, not a rainbow pixel<br />3 = white color, not a rainbow pixel<br /><br />4 = no effect, rainbow pixel<br />5 = level effect color1, rainbow pixel<br />6 = level effect color2, rainbow pixel<br />7 = white color, rainbow pixel</span><br /><br /><span style="color: blue;">Blue channel:<br />0-255 amount of effect color</span><br /><br />My hope and dream is that the level editor will be able to encode each pixel with this information, save it as a .png, and then a fragment shader in unity will be able to decipher it and color the level dynamically. Tune in tomorrow to see it shattered.<br /><br />Unity wizards (like Jimbert!) can you give me a quick heads up on one thing - if I want to feed a shader a palette of something like 12 colors, what&#039;s more efficient? Feeding it as params, or feeding it a tiny little secondary texture where it can pick the colors?<br /><br /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#550">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="551"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020039#msg1020039" target="_blank">JLJac on May 06, 2014, 11:21:47 AM:</a></b></td></table><br>All the more reason to fight to keep the pixels pure then haha! I&#039;m a bit more worried that I&#039;ve heard you shouldn&#039;t use if statements in shaders, and the decoding of this system is obviously going to be a huge knot of ifs and modulus operations...</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#551">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="552"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/jamesprimate.jpg" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020181#msg1020181" target="_blank">jamesprimate on May 07, 2014, 01:55:50 AM:</a></b></td></table><br><div class="quoteheader"><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020071#msg1020071">Quote from: Christian on May 06, 2014, 01:30:04 PM</a></div><div class="quote">In this <a href="http://www.gdcvault.com/play/1020583/Animation-Bootcamp-An-Indie-Approach" target="_blank">GDC 2014 talk</a> by David Rosen, a dev working on Wolfire&#039;s Overgrowth, he&#039;s discussing procedural animations in indie games and talks about Rain World around the 20 minute mark. The whole talk is really interesting though<br /></div><br />ah yes! thanks for the link. David contacted us a while back to ask questions and if we&#039;d be cool with him using RW as an example. which is awesome because that was a fantastic presentation, I learned a lot. Not as much as from Gimym&#039;s links though <img src="/Rain-World-Devlog/Images/Smileys/grin.gif" alt="Grin" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#552">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="553"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020188#msg1020188" target="_blank">JLJac on May 07, 2014, 02:27:52 AM (Last Edit: May 07, 2014, 03:51:22 AM):</a></b></td></table><br>Awesome! Thank you, Jimbert <img src="/Rain-World-Devlog/Images/Smileys/grin.gif" alt="Grin" border="0" /> My implementation is actually very similar to those gradient maps, except my input is ... what would it be, 7 dimensional, and the output is a coordinate on a 2D palette texture rather than an 1-dimensional gradient.<br /><br />I&#039;ve had pretty good luck today, and got quite far with my deciphering algorithm! Then I ran into a weird error. I hit my instruction limit, which was kind of due to happen because the basic settings only allow for 64 instructions.<br /><br />No biggie, let&#039;s just upgrade to shader model 3.0, right? That&#039;s like, 2003 graphic cards or something, people&#039;s PC&#039;s will be able to handle that.<br /><br />No can do. For some reason Unity says &quot;no subshaders can run at this graphics card&quot; if I target the shader at anything higher than 2.0. Unity refuses to believe anything else than that my graphics card is from 2002. <br /><br />I&#039;ve searched Unity&#039;s settings for the &quot;dude I bought my computer 2 months ago it&#039;s not ten years old&quot;-checkbox, but can&#039;t seem to find it. There&#039;s an option to <i>emulate </i>for 3.0, in order to try the compability with older machines, but since Unity is adamant that my machine is even older than those older machines, no luck.<br /><br />Any tips?<br /><br />Found a command SystemInfo.graphicsShaderLevel in Unity, and this claims that I have 3.0, which is worrying for every reason. First, if I have 3.0 it <i>should</i> work, right? Second, I <i>don&#039;t</i> have 3.0, I&#039;m supposed to have 5.0! Fun times! </div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#553">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="554"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020218#msg1020218" target="_blank">JLJac on May 07, 2014, 04:35:29 AM:</a></b></td></table><br>James solved it.... Hahahahahaha!&nbsp; <br /><br />I was looking for high tech solutions all over, and the answer was this: Go to the &quot;We now feature directx 11&quot; page on unity.com - acquire the information that in order for complex shaders to work, you need to tick the &quot;use directx 11&quot; box in the unity editor. Tick the &quot;use directx 11&quot; box.<br /><img src="/Rain-World-Devlog/Images/Smileys/cheesy.gif" alt="Cheesy" border="0" /> <img src="/Rain-World-Devlog/Images/Smileys/facepalm.gif" alt="Facepalm" border="0" /> <img src="/Rain-World-Devlog/Images/Smileys/tired.gif" alt="Tired" border="0" /> <img src="/Rain-World-Devlog/Images/Smileys/tearsofjoy.gif" alt="Tears of Joy" border="0" /> <img src="/Rain-World-Devlog/Images/Smileys/cry.gif" alt="Cry" border="0" /> <img src="/Rain-World-Devlog/Images/Smileys/epileptic.gif" alt="Epileptic" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#554">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="555"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020280#msg1020280" target="_blank">JLJac on May 07, 2014, 08:55:23 AM:</a></b></td></table><br>I&#039;ll write a fallback shader, so no worries <img src="/Rain-World-Devlog/Images/Smileys/smiley.gif" alt="Smiley" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#555">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="556"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020332#msg1020332" target="_blank">JLJac on May 07, 2014, 11:40:50 AM:</a></b></td></table><br><b>Update 134</b><br />A very good day!<br /><br />I got a good chunk of my shader done - there is still work (dynamic palettes, effect colors, the rainbow effect, etc etc) but now I know that the basics work. <br /><br />The level editor encodes an image looking as such:<br /><br /><a href="http://oi62.tinypic.com/jsfz86.jpg" target="_blank"><table style="background-color:#b090a040; border:1px solid #ffffff; padding:5px"><td><img src="/Rain-World-Devlog/Images/LOST IMAGE.png" width="150px" alt="" border="0"/></td></table></a><br /><br />This in turn is deciphered by the shader, which can tell things such as depth, whether or not the pixel is lit, and all that stuff I mentioned in the last post.<br /><br /><table style="background-color:#b090a040; border:1px solid #ffffff; padding:5px"><td><img src="/Rain-World-Devlog/Images/LOST IMAGE.png" width="150px" alt="" border="0"/></td></table><br /><br />The shader is also fed another texture, a palette texture which is very small. In the future I think it might be cool to be able to interpolate between different palettes, to do cool effects such as darkening as the rain comes, lightning and the such.<br /><br /><table style="background-color:#b090a040; border:1px solid #ffffff; padding:5px"><td><img src="/Rain-World-Devlog/Images/LOST IMAGE.png" width="150px" alt="" border="0"/></td></table><br /><br />This one has a little bit of random static in it - that will not likely stay, I&#039;m just having fun.<br /><br />And, finally, I got my dynamic shadows to work!<br /><br /><img src="/Rain-World-Devlog/Images/Archived Images/mCR4.gif" alt="" border="0" /><br /><br />Woooho! <br /><br />I have it working with the normal color scheme as well, just used this wacky palette so you&#039;d see clearer. The principle is super simple: each pixel has a depth value (red in the mockup). If it&#039;s lit, it looks at a certain pixel to check if it&#039;s occupied by a sprite. Which pixel it looks at is determined by stepping backwards in the light direction.<br /><br />So say that I&#039;m a lit pixel that&#039;s at a depth of 5. Then I step, for simplicity&#039;s sake, 5 pixels to the left and upwards, and ask that pixel if it has something rendered on it. If true, I become shadowed. If I&#039;m at a greater depth, I go more steps up and to the left.<br /><br />It&#039;s unpolished - for example it doesn&#039;t take notice of perspective yet. If the shadows are cast straight backwards, you&#039;d want them to stretch towards the center of the screen according to perspective, right, and that&#039;s not factored in yet. But I&#039;m getting there!<br /><br />Super exciting to see that it works!</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#556">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="557"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/jamesprimate.jpg" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020405#msg1020405" target="_blank">jamesprimate on May 07, 2014, 04:41:11 PM:</a></b></td></table><br>&nbsp;<div class="quoteheader"><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020332#msg1020332">Quote from: JLJac on May 07, 2014, 11:40:50 AM</a></div><div class="quote"><b>Update 134</b><br />A very good day! </div><br />&nbsp;<img src="/Rain-World-Devlog/Images/Smileys/tearsofjoy.gif" alt="Tears of Joy" border="0" /></div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#557">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="558"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020475#msg1020475" target="_blank">JLJac on May 07, 2014, 10:42:12 PM:</a></b></td></table><br>No, I&#039;m actually not raymarching, as I don&#039;t do any step-by-step checking of different depths. Instead the procedure has only two steps:<br /><br />1. Check the pixel and get its info, which is color info but also depth (already encoded by the level editor).<br /><br />2. Use the depth to check for where in the grab texture to look for objects that shadow this pixel. The greater the depth, the more up/left we check.<br /><br />Effect: If you are in front of a wall, there will be a shadow on the wall. The further back the wall is, the further down/right the shadow will appear.<br /><br />Your pseudo code is super helpful, by reading it I see a lot of things I can optimize in my shader! It&#039;s impressive that you manage to keep away from if-statements like that!<br /><br />My texture looks like this:<br /><br /><table style="background-color:#b090a040; border:1px solid #ffffff; padding:5px"><td><img src="/Rain-World-Devlog/Images/LOST IMAGE.png" width="150px" alt="" border="0"/></td></table><br /><br />So that&#039;s the same basic idea, right?</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#558">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br><br>
<a name="559"></a><div style="display:flex"><div style="flex-basis:10%"></div><div style="flex-basis:80%; max-width:80%"><div class="post"><table><td><img src="/Rain-World-Devlog/Images/JLJac.gif" style="vertical-align:middle"/>&nbsp;&nbsp;&nbsp;</td><td><b><a href="https://forums.tigsource.com/index.php?topic=25183.msg1020489#msg1020489" target="_blank">JLJac on May 08, 2014, 12:50:01 AM:</a></b></td></table><br>Thanks&nbsp; <img src="/Rain-World-Devlog/Images/Smileys/smiley.gif" alt="Smiley" border="0" /><br /><br />Ugh, can someone clue me in on the quirks of the CG compiler? Is there a list somewhere? It certainly does <i>not </i>execute the the code linearly in the way that I&#039;d expect, that&#039;s for sure!<br /><br />Example:<br /><br /><div class="codeheader">Code:</div><div class="code"> <br />if (light){<br />&nbsp; setColor = half4(0, 1, 0, 1);<br />}else{<br />&nbsp; setColor = half4(1, 0, 1, 1);<br />}</div><br />This code makes the lit areas green and the other areas purple, as expected. This though:<br /><br /><div class="codeheader">Code:</div><div class="code"> <br />if (light){<br />&nbsp; setColor = tex2D(_PalTex, float2(red/30.0, 1.0-((paletteColor + 3)/7.0)));<br />}else{<br />&nbsp; setColor = tex2D(_PalTex, float2(red/30.0, 1.0-(paletteColor/7.0)));<br />}</div><br />doesn&#039;t work, it executes the &quot;else&quot; always, never the &quot;if&quot; <img src="/Rain-World-Devlog/Images/Smileys/crazy.gif" alt="Crazy" border="0" /> No other changes!<br /><br />This:<br /><br /><div class="codeheader">Code:</div><div class="code"> <br />&nbsp;if (light)<br />&nbsp; &nbsp;paletteColor += 3;<br /><br />&nbsp;setColor = tex2D(_PalTex, float2(red/30.0, 1.0-(paletteColor/7.0)));<br /></div><br />works, and according to my logic that is the exact same thing as the one above it. Confused&nbsp; <img src="/Rain-World-Devlog/Images/Smileys/crazy.gif" alt="Crazy" border="0" /><br /><br />I&#039;ve been told that shaders work more in parallel an less linearly, and I guess this is that, but I just can&#039;t wrap my head around how it works. To me it seems to just be random. What&#039;s going on?</div><div style="font-size:80%">&nbsp;&nbsp;&nbsp;<a href="/Rain-World-Devlog/Pages/028.html#559">[Message link]</a></div></div><div style="flex-basis:10%"></div></div>
<br><br><hr><br>
<span style="background-color:#151015ea"><a href="/Rain-World-Devlog/Pages/027.html">Previous page</a> / <a href="/Rain-World-Devlog/Pages/029.html">Next page</a></span></body>